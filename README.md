# Гайд по естімейтах проєктів

## Важливо
* Якщо можливо краще робити естімейт в ренжі (наприклад 2-3h замість 2h) так ми будемо знати скільки часу піде на розробку в кращому та гіршому випадках, а також уникнемо більшості ситуацій з неправильним естімейтом
* Якщо можливо, то уточнити очікувані замовником часові рамки, щоб оптимізувати естімейт, спростивши код в певних місця (але може привести до накопичення технічного боргу).
* Якщо проєкт не потребує рефактору коду, а скоп робіт це рескін або редизай, то ні в якому випадку не намагатися почати проєкт з нуля. На перший погляд гарна ідея, але на практиці це скоріше за все приведе до невчасної здачі проєкту.
* Під час сладання естімейту командою не потрібно надавати перевагу думці іншої людини, варто особисто перевірити і скоригувати естімейт на основі гайду та ваших можливостей

```
"потребує рефактору коду" - означає виплату технічного боргу проєкту.
Тому краще не рефакторити те, що не планує довгостроково підтримуватися.
```

---

## Існуючий проєкт

### 1. Дослідити стек
Скласти загальне розуміння чи команда має достатньо знань чи потрібно виділити час на дослідення нових бібліотек.

### 2. Оглянути скоуп робіт

#### 1. Рескін

##### 1.1 Оглянути яка стилізація використовується в проєкті
* css/scss - відносно легка зміна стилів якщо немає великих файлів або !important
* Styled Components - те ж саме що і попередній пункт, але може викликати плутанину між функціональною компонентою та компонентою-стилем
* tailwind - найважчий варіант, особливо складно може бути у випадку якщо класи не погруповані за сутнітню (flex/grid, colors, position і тд) і/або написані в 1 рядок без використання clsx

##### 1.2. Дослідити розмір та складність секцій (тільки HTML/JSX)
```
Секція - це блок на сторінці (форма, таблиця, список, графік і тд)

Тільки HTML/TSX тому що нам не важлива реалізація, ми працюємо тільки з візуалом
```

###### Складність
Варто взяти до уваги чи є графіки, таблиці, абсолютно позиціоновані декорації та інші потенційно неприємні елементи. Також звернути увагу чи мобільна версія секції є адаптивом десктопу чи окремою компонентою, у випадку якщо це окрема компонента, то її потрібно естімейтити окремо.

```
Прикладом окремої компоненти для мобільної версії можуть бути форми які часто
стають модалками для малих екранів
```

###### Розмір (HTML/JSX коду)
* Масивний - секція містить стилізацію космічного корябля, тому потрібно умовно поділити її на менші частини та естімейтити кожну окремо. Скоріше за все вкладені компоненти будуть невеликих розмірів або їх не буде взагалі, але для певності краще проглянути їх
* Середньо-малий - проблем виникнути не має, але є можливість що вкладені компоненти будуть обʼємними, тому варто проглянути їх

#### 2. Редизайн
Все те ж саме що і для рескіну, але може змінитися позиція чи дані секцій або додатися нові. Тому потрібно:

* Проглянути хуки, стори, api
* Оцінити складність поточної реалізації
* Оцінити можливості до розширення або зміни функціоналу

```
Не варто рефакторити код, якщо ми можемо розширити функціонал відносно безболісно.
Рефактор незнайомого коду як правило займає дні або навіть тижні.
```

#### 3. Переробка з нуля
Включає в себе попередні пункти + написання логіки з нуля або рефактор

##### 3.1. Функціонал пишеться наново
Див. частину 2. Проєкт з нуля

##### 3.2. Перенесення з рефактором
```
Рефактор в старому проєкті буде кращим рішенням, якщо немає гострої необхідності
в оптимізації, пришвидшенні білда на cloud або сторонніх інтеграціях для яких
необхідне повне оновлення фреймворку
```

Тут потрібно детально розглянути реалізацію ключових функціональних елементів та можливі підводні камені.

##### Підводні камені

* Велика кількість калькуляцій - вони також можуть бути комплексні, тому фактичний час виконання може вийти за рамки, якщо не закласти це в естімейт
* Багато залежностей - хуки, стори, api якщо компонента комбінує в собі ці елементи, а ми цього не очікували це може сильно затягнути рефактор
* Дублікація коду - не завжди потрібно рефакторити, але якщо плануєте прибрати дублікати, то це необхідно закласти в естімейт
* Декілька джерел істини - проєкт може мати однакові константи з різними значеннями (наприклад адреси контраків), що може призвести до небажаних багів які важко буде відловити

```
Якщо функціоналу забагато, щоб відносно швидко оцінити його, то можна використати
AI для складання summary (це буде швидше, але менш точно)
```

---

## Проєкт з нуля

### 1. Огляд документації та дизайну
Перед початком естімейту потрібно детально дослідити документацію та дизайн для загального розуміння суті проєкту.
Не забути врахувати в естімейт наявність наступних деталей:

* Теми - в процесі розробки додає мінімум часу при правильному сетапі.
Але сам сетап займе деякий час, на практиці це до 4 годин в залежності від кількості варіацій
* Локалізації - Процес додавання може бути затяжним, якщо мов багато та локалізації для авто-згенеровані (api, AI).
Якщо це авто-генерація то займе мінімум часу. Сам сетап з тестами займає до 1 дня.
* Складні Анімації - без референсів це темна конячка, потрібно приділити час на дослідження складності.
Можна використати gsap (потужна бібліотека яка має приклади більшості складних анімацій та легка у використанні)

#### Нюанси та рішення
* Відсутній дизайн - залучити дизайнерів для створення прототипу або якщо це не можливо, то дослідити існуючі проєкти 
* Документація не повна - проговорити з PM кожний пункт детально, занотувати і обдумати
```
Якщо це естімейт-дзвінок не потрібно одразу приймати рішення через бажання розібратися з цим
на місці, краще після дзвінку переглянути нотатки і зробити детальний естімейт
```

### 2. Складання плану естімейту відносно доступної інформації

```
Не варто завжди спиратися тільки на дизайн, краще проглянути відповідний пункт в документації,
після цього співставити дизайн з вимогами і працювати з повною картиною
```

#### 2.1 Розбиття задачі на блоки
Завдання може бути "Імплементувати сторінку", що не говорить для нас обсолютно нічого,
тому робимо декомпозицію до деталей.

``сторінка > секція > блок > компонента``

```
Секція - це блок на сторінці (форма, таблиця, список, графік і тд)
Блок - група компонентів в секції (якщо це форма то блоками будуть: інпути, кнопки, деталі)
Компонента - елемент блоку з функціоналом або даними
```

#### 2.2 Порядок естімейту
1. Компоненти - саме з них ми будуємо блоки і саме вони містять функціонал або дані
2. Блоки - потребують групування та розміщення готових компонентів з урахуванням адаптиву
3. Секція - як і в попередньому пункті, але будуємо з блоків і враховуємо інтеграцію між ними (пропси, контекст, можливо стор) та валідації якщо це форма
4. Сторінка - побудована з секцій, має адаптив та можливо стор

### 3. Естімейт

#### 3.1 Компоненти

##### Функціональні компоненти
Функціональні компоненти можуть мати складну бізнес логіку і/або працювати з api,
тому декілька пунктів які ми маємо врахувати
* складність логіки та її залежності (можуть бути дані з форми або api)
* складність інтеграції api
* необхідність авто-тестів

##### Компоненти з даними
Тут важливо розуміти джерела даних та врахувати необхідність їх агрегації або додаткових калькуляцій

#### 3.2 Блоки
Ми вже маємо готові компоненти тому достатньо їх розмітити, додати деякі стилі, адаптив та не складну логіку

```
Зазвичай займає небагато часу
```

#### 3.3 Секція
Тут важливо подумати про декілька речей:
* Валідації - якщо це форма то потрібно її валідувати
* Інтеграції між блоками - можливо доведеться передавати дані між блоками або синхронізовувати їх стан,
а це реалізація передачі пропсів, контексту або окремого стору
* Мобільний адаптив - потрібно врахувати чи це графік, таблиця, секція з абсолютно позиціонованими елементами або інша неприємна для адаптиву річ
* Інтеграційні тести - тестування інтеграцій між блоками

#### 3.4 Сторінка
Імплементація layout та його адаптив

## Оптимізації робочого процесу

### 1. Api
Часто бувають випалки коли дев може "зависнути" в очікуванні блокуючого api,
тому доцільно буде закласти в естімейт створення mock серверу.

[json-server]((https://www.npmjs.com/package/json-server))
```
mock-server - налаштований json server, що містить mock дані
(тестові дані можна генерувати за допомогою AI)
```

### 2. Unit та інтеграційні тести
Якщо вам здається що unit тести це пуста трата часу, то це не так.
Ось декілька ситуацій коли варто не ігнорувати unit тести.

* Валідації форми - часто буває, що при апдейті логіки форми, щось забули виправити або додати.
При ручному тестуванні ви не помітите різниці, але QA або в гіршому випадку користувач обовʼязково знайде проблему
* Калькуляції - якщо калькуляції мають багато місць використання і на основі них відбуваються подальші калькуляції в багатьох місцях,
то скоріше за все при апдеті логіки ви пропустите пару необхідних апдейтів.
* Відображення - маємо складну логіку відображення і багато умов.

Інтеграційні тести
* Форма з глобальною модалкою - юніт тести підкажуть нам чи все добре з валідаціями, а інтеграційні чи змінилися стан в сторі і чи модалка реагує на цю зміну
* Api - перевірка даних та error state
* Роутинг - як працюють редіректи, middleware, 404 та інші сторінки

Будь який з Unit та інтеграційних пунктів тестувати вручну важко і довго, щоб не витрачати дорогоцінний час на ручну перевірку,
краще додати авто-тести які перед пушом покажуть чи все працює як очікується.

```
Тестування застосунку може суттєво зменшити час тест-циклу,
адже воно скорочує кількість повернень задачі та приберає більшість проблем
з постійним відтворенням одного багу після декількох ітерацій
```
### 3. e2e тести
Корисні у випадках тестування повного флоу.
* Сильно економить час на перевірку комплексної логіки та взємодій.
* Дозволяє швидко на місці відловити помилку при зміні частини комплексної логіки.

### 4. Використання AI
* Верстка - використання Claude sonnet 4.5 з підключеним Figma mcp дозволяє швидко зробити ui-kit, блоки та інколи секції.
Достатньо вибрати фрейм і попросити AI імплементувати ui з використання проєктних стилів та компоненів
* Мок дані - генерація даних для json-server
* План рефактору - краще не рефакторити код за допомогою AI, а складати план який допоможе зробити це самостійно
* Summary - якщо не потрібно поглиблених деталей, але є необхідність розібратися що відбувається

```
!!! Будь які дії AI повинні бути провалідовані девом перед пушом
```
